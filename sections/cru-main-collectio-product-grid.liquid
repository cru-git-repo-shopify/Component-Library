{% assign all_tags = collections.all.all_tags %}

<div class="shop_filter" style="padding-bottom: 50px;">
  <h2 class="filter-title">Filter by <i class="fa-solid fa-sliders"></i> <span>Category:</span></h2>
  <ul>
    <li><a class="term-item active" href="*">All Products</a></li>
      {% for tag in all_tags %}
          <li><a class="term-item" href=".product_cat-{{ tag | handle }}">{{ tag }}</a></li>
      {% endfor %}
  </ul>
</div>
<div class="filter_mobile">
  <select class="filters_select">
    <option value="*">All Wines</option>
      {% for tag in all_tags %}
        <option value=".product_cat-{{ tag | handle }}">{{ tag }}</option>
      {% endfor %}
  </select>
</div>

{% paginate collections.all.products by section.settings.products_per_page %}
<div class="cru-product-collection">
    {% for product in collections.all.products %}
        <div class="cru-product-item {% for tag in product.tags %}product_cat-{{ tag | handle }} {% endfor %}" style="background-color: {{ product.metafields.custom.product_background_color }};">
          {% assign points = product.metafields.custom.award_points %}
          {% assign badges = product.metafields.custom.award_badge %}
          {%  assign index = 0 %}
          {% if product.metafields.custom.label != blank %}
            {%  if product.metafields.custom.special_label %}
              {%  assign label_type =  'special' %}
            {% else %}
              {%  assign label_type =  'normal' %}
            {% endif %}
            <div class="product-custom-label orange {{ label_type }}"><p>{{ product.metafields.custom.label }}</p></div>
          {% endif %}
          {% if points != blank or badges != blank %}
            <div class="product_awards">
              {% if points != blank %}
                {% for award in points.value %}
                  <p class="award award_accolade" style="z-index: {{ index }};"><span class="points">{{ award }}</span><span class="type">PTS</span></p>
                  {% assign index = index | plus: 1 %}
                {% endfor %}
              {% endif %}
              {% for badge in badges.value %}
                <img src="{{ badge | img_url: 'large' }}" alt="Award Badge" class="badge award_accolade" style="z-index: {{ index }};">
                {% assign index = index | plus: 1 %}
              {% endfor %}
            </div>
            {% endif %}
          
            <a href="{{ product.url }}">
                <img src="{{ product.featured_image | img_url: 'large' }}" alt="{{ product.title }}" class="product-image ">
            </a>
            <div class="product-info">
                <p class="product-title"><a href="{{ product.url }}">{{ product.title }}</a></p>
                <p class="product-price">{{ product.price | money }}</p>
                {% if product.available %}
                    <div class="ajax-add-to-cart" data-variant-id="{{ product.variants.first.id }}">
                        <div class="quantity-wrapper">
                          <div class="quantity-wrapper-inner">
                            <button type="button" class="qty-btn minus">âˆ’</button>
                            <input
                                type="number"
                                name="quantity"
                                min="1"
                                value="1"
                                class="quantity-input"
                            >
                            <button type="button" class="qty-btn plus">+</button>
                          </div>
                        </div>
                        <div class="add-to-cart-wrapper">
                            <button class="add-to-cart-button">Add to Cart</button>
                            {% comment %} <span class="add-status"></span> {% endcomment %}
                        </div>
                    </div>
                    {% else %}
                    <p class="sold-out">Sold Out</p>
                {% endif %}
            </div>
        </div>
    {% endfor %}
    {% comment %} <div class="pagination">
        <span class="page-info">Page {{ paginate.current_page }} of {{ paginate.pages }}</span>
        <div class="page-links">
            {% if paginate.previous %}
                <a href="{{ paginate.previous.url }}" class="prev">Previous</a>
            {% endif %}
            {% if paginate.next %}
                <a href="{{ paginate.next.url }}" class="next">Next</a>
            {% endif %}
        </div>
    </div> {% endcomment %}
</div>
{% endpaginate %}

<script>


</script>

{% schema %}
{
  "name": "CRU Product Collection",
  "settings": [
    {
      "type": "number",
      "id": "products_per_page",
      "label": "Products per page",
      "default": 12
    }
  ],
  "presets": [
    {
        "name": "CRU Product Collection",
        "category": "Custom"
    }
  ]
}
{% endschema %}